% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runConsensusNMF.R
\name{runConsensusNMF}
\alias{runConsensusNMF}
\title{Run Consensus Non-negative Matrix Factorization on SingleCellExperiment objects}
\usage{
runConsensusNMF(
  x,
  k_range = 5:15,
  n_runs = 100,
  assay = "logcounts",
  name = "cNMF",
  subset_row = NULL,
  tol = 1e-05,
  maxit = 100,
  L1 = c(0, 0),
  seed = NULL,
  verbose = TRUE,
  n_cores = 1,
  ...
)
}
\arguments{
\item{x}{A SingleCellExperiment or SpatialExperiment object}

\item{k_range}{Integer vector, range of K values to test (default 5:15)}

\item{n_runs}{Integer, number of NMF runs per K value (default 100)}

\item{assay}{Character or integer, which assay to use (default "logcounts")}

\item{name}{Character, name for storing results (default "cNMF")}

\item{subset_row}{Vector specifying which features to use}

\item{tol}{Numeric, tolerance for convergence (default 1e-5)}

\item{maxit}{Integer, maximum iterations per run (default 100)}

\item{L1}{Numeric vector of length 2, L1 regularization for [w, h] (default c(0,0))}

\item{seed}{Integer, random seed for reproducibility}

\item{verbose}{Logical, whether to print progress (default TRUE)}

\item{n_cores}{Integer, number of cores for parallel processing (default 1)}

\item{...}{Additional arguments passed to RcppML::nmf}
}
\value{
The input object with cNMF results stored in metadata(x)$cNMF
  and optimal usage matrix in reducedDims
}
\description{
Performs consensus NMF (cNMF) by running multiple NMF iterations and combining
results to identify stable gene expression programs. This approach increases
robustness and accuracy compared to single NMF runs.
}
\examples{
# Single-cell example
library(scuttle)
sce <- mockSCE(ngenes = 500, ncells = 200)
sce <- logNormCounts(sce)
sce <- runConsensusNMF(sce, k_range = 5:10, n_runs = 20)

# Access consensus results
geps <- getConsensusGEPs(sce)
usage <- getGEPUsage(sce)

}
